<!DOCTYPE html>
<html data-bs-theme="light" lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Plex Mining - Bitcoin mining dashboard mit PV-Integration und Wetterprognose">
    <title>Plex Mining</title>
    <link rel="stylesheet" href="lib/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="res/style.css">
</head>
<body>
    <header>
        <img src="res/plexmining2.jpg" alt="Plex Mining Logo" loading="eager">
        <h1>Plex Mining <span>0.6.1</span></h1>
    </header>

    <main class="container">
        <section class="row">
            <div class="col-md-6">
                <div class="card same-height">
                    <div class="card-body">
                        <h5 class="card-title">PV & Batterie <small class="text-muted float-end" id="ts-pv"></small></h5>
                        <div class="d-flex">
                            <div class="flex-grow-1">
                                <ul>
                                    <li>Aktuelle PV-Leistung (W): <span id="pv-leistung"></span></li>
                                    <li>Batteriestand (kWh + %): <span id="batterie-stand"></span></li>
                                    <li>Netzbezug / Einspeisung (W): <span id="netz-leistung"></span></li>
                                    <li>Verbrauch (Hauslast in W): <span id="haus-last"></span></li>
                                </ul>
                            </div>
                            <img src="res/section_pv.png" alt="PV Section Image" class="ml-3 section-image" width="200" height="150" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card same-height">
                    <div class="card-body">
                        <h5 class="card-title">Wetter & Prognose <small class="text-muted float-end" id="ts-weather"></small></h5>
                        <div class="d-flex">
                            <div class="flex-grow-1">
                                <div class="table-responsive">
                                    <table class="table table-sm mb-2" style="max-width: 520px;">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>Heute</th>
                                                <th>Morgen</th>
                                                <th>7 Tage</th>
                                                <th>14 Tage</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th class="text-muted">Sonnenstunden (h)</th>
                                                <td id="sun-today"></td>
                                                <td id="sun-tomorrow"></td>
                                                <td id="sun-7d"></td>
                                                <td id="sun-14d"></td>
                                            </tr>
                                            <tr>
                                                <th class="text-muted">Strahlung (Wh/m²)</th>
                                                <td id="rad-today"></td>
                                                <td id="rad-tomorrow"></td>
                                                <td id="rad-7d"></td>
                                                <td id="rad-14d"></td>
                                            </tr>
                                                <tr>
                                                    <th class="text-muted">PV-Ertrag (kWh)</th>
                                                    <td id="pv-today"></td>
                                                    <td id="pv-tomorrow"></td>
                                                    <td id="pv-7d"></td>
                                                    <td id="pv-14d"></td>
                                                </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div id="weather-chart" class="my-3" style="width: 100%; height: 260px;"></div>
                                <div class="accordion" id="weatherAccordion">
                                  <div class="accordion-item">
                                    <h2 class="accordion-header" id="headingWeatherTable">
                                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseWeatherTable" aria-expanded="false" aria-controls="collapseWeatherTable">
                                        Tabelle anzeigen
                                      </button>
                                    </h2>
                                    <div id="collapseWeatherTable" class="accordion-collapse collapse" aria-labelledby="headingWeatherTable" data-bs-parent="#weatherAccordion">
                                      <div class="accordion-body">
                                        <div class="table-responsive">
                                          <table class="table table-sm" id="weather-table">
                                            <thead>
                                              <tr>
                                                <th scope="col">Datum</th>
                                                <th scope="col">Sonnenstunden</th>
                                                <th scope="col">Strahlung (Wh/m²)</th>
                                                <th scope="col">PV-Ertrag (kWh)</th>
                                              </tr>
                                            </thead>
                                            <tbody id="weather-table-body"></tbody>
                                          </table>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <section class="row">
             <div class="col-md-6">
                <div class="card same-height">
                    <div class="card-body">
                        <h5 class="card-title">Steuerungselemente</h5>
                        <div class="btn-group mb-3" role="group" aria-label="Miner controls">
                            <button class="btn btn-primary" type="button">Start Miner</button>
                            <button class="btn btn-danger" type="button">Stop Miner</button>
                            <button class="btn btn-secondary" type="button">Restart Miner</button>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="auto-mode">
                                <label class="form-check-label" for="auto-mode">Auto-Mode</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="power-limit" class="form-label">Power-Limit / Taktung pro Miner:</label>
                            <input type="range" class="form-range" id="power-limit" name="power-limit" min="0" max="100">
                        </div>
                        <button class="btn btn-dark" type="button">Alles aus</button>
                    </div>
                </div>

             </div>
             <div class="col-md-6">
                 <div class="card same-height">
                    <div class="card-body">
                        <h5 class="card-title">Systeminfos <small class="text-muted float-end" id="ts-system"></small></h5>
                        <ul>
                            <li>Zeitstempel der letzten Datenaktualisierung: <span id="last-update"></span></li>
                            <li>API-Status (Wetter, PV-Anlage erreichbar?): <span id="api-status"></span></li>
                            <li>Logauszug (Fehler/Warnings): <span id="log-auszug"></span></li>
                            <li>Bitcoin Netzwerk:
                                <ul>
                                    <li>Total Hashrate: <span id="btc-total-hashrate"></span></li>
                                    <li>Hash Price Index: <span id="btc-hash-price-index"></span></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>


        </section>

        <section class="row">

            <div class="col-md-6">
                <div class="card same-height">
                    <div class="card-body">
                        <h5 class="card-title">Ökonomie-Kalkulation <small class="text-muted float-end" id="ts-economy"></small></h5>
                        <div class="d-flex">
                            <div class="flex-grow-1">
                                <ul>
                                    <li>Geschätzte Stromkosten (€/h, €/Tag): <span id="strom-kosten"></span></li>
                                    <li>Ersparnis durch PV (%): <span id="pv-ersparnis"></span></li>
                                    <li>BTC-Ertrag (aktuell / hochgerechnet): <span id="btc-ertrag"></span></li>
                                </ul>
                            </div>
                            <img src="res/section_economy.png" alt="Economic Section Image" class="ml-3 section-image" width="200" height="150" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>

             <div class="col-md-6">
                <div class="card same-height">
                    <div class="card-body">
                        <h5 class="card-title">14-Tage-Mining-Prognose <small class="text-muted float-end" id="ts-forecast"></small></h5>
                        <ul>
                            <li>Gesamt-Laufzeit: <span id="prognose-gesamt-laufzeit"></span></li>
                            <li>Gesamt-kWh: <span id="prognose-gesamt-kwh"></span></li>
                            <li>Gesamt-Einnahmen: <span id="prognose-gesamt-einnahmen"></span></li>
                            <li>Gesamt-Ausgaben: <span id="prognose-gesamt-ausgaben"></span></li>
                            <br>
                            <li>Durchschnittliche Laufzeit pro Tag: <span id="prognose-tag-laufzeit"></span></li>
                            <li>Durchschnittliche kWh pro Tag: <span id="prognose-tag-kwh"></span></li>
                            <li>Durchschnittliche Einnahmen pro Tag: <span id="prognose-tag-einnahmen"></span></li>
                            <li>Durchschnittliche Ausgaben pro Tag: <span id="prognose-tag-ausgaben"></span></li>
                        </ul>
                    </div>
                </div>
            </div>


        </section>

        <section class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Miner <small class="text-muted float-end" id="ts-miners"></small></h5>
                        <ul>
                            <li>Anzahl aktiver Miner / Gesamt: <span id="miner-anzahl"></span></li>
                        </ul>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover" id="miner-table">
                                <thead class="table-dark">
                                    <tr>
                                        <th scope="col">Miner ID</th>
                                        <th scope="col">Modell</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Hashrate (TH/s)</th>
                                        <th scope="col">Stromaufnahme (W)</th>
                                        <th scope="col">Temperatur (°C)</th>
                                        <th scope="col">BTC/kWh</th>
                                        <th scope="col">€/kWh</th>
                                    </tr>
                                </thead>
                                <tbody id="miner-table-body">
                                    <!-- Dynamic content will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                         Auto-Mode: an/aus <span id="miner-auto-mode"></span>
                    </div>
                </div>
            </div>
        </section>
    </main>


    <script src="lib/bootstrap/js/bootstrap.bundle.min.js" defer></script>
    <script src="lib/d3/d3.v7.min.js" defer></script>
    <script src="res/helper.js" defer></script>
    <script src="res/graphs.js" defer></script>
    <script src="res/script.js" defer></script>
    <footer class="footer mt-auto py-3 bg-light">
      <div class="container">
        <span class="text-muted">© 2025 Alexander Thurn | <a href="https://github.com/alexanderthurn/plexmining">GitHub Repository</a></span>
      </div>
    </footer>
</body>
</html>